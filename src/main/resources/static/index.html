<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>代码生产工具</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<div class="page-header center">
    <h1 class="center">Mybatis 代码生产工具</h1>
</div>
<p>基于mybatis代码生成工具。</p>
<div id="db-connect-div" class="panel panel-info">
    <div class="panel-heading">
        <a id="db-connect-a" data-toggle="collapse" data-parent="#accordion" href="#collapse-db">
            <h3 class="panel-title">第一步：连接数据库</h3>
        </a>
    </div>
    <div id="collapse-db" class="panel-collapse collapse in">
        <div class="panel-body">
            <form class="form-horizontal" role="form">
                <div class="form-group">
                    <label for="db-type" class="col-sm-2 control-label">数据库类型</label>
                    <div class="col-sm-10">
                        <select id="db-type" class="form-control">
                            <option value="MySQL">MySQL</option>
                            <option value="SQLite">SQLite</option>
                            <option value="SQL Server">SQL Server</option>
                            <option value="Oracle">Oracle</option>
                            <option value="H2">H2</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="db-server" class="col-sm-2 control-label">服务器地址</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="db-server" placeholder="请输入服务器地址" value="127.0.0.1">
                    </div>
                </div>
                <div class="form-group">
                    <label for="db-port" class="col-sm-2 control-label">端口号</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="db-port" placeholder="请输端口号" value="3306">
                    </div>
                </div>
                <div class="form-group">
                    <label for="db-database" class="col-sm-2 control-label">数据库名</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="db-database"
                               placeholder="请输数据库名" value="it_bs">
                    </div>
                </div>
                <div class="form-group">
                    <label for="db-username" class="col-sm-2 control-label">登录名</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="db-username"
                               placeholder="请输登录名" value="root">
                    </div>
                </div>
                <div class="form-group">
                    <label for="db-password" class="col-sm-2 control-label">密码</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="db-password"
                               placeholder="请输密码" value="root">
                    </div>
                </div>
            </form>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button id="connect-db-submit" type="submit" class="btn btn-primary">开始连接</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="gen-div" class="hidden">
    <div class="panel panel-info">
        <div class="panel-heading">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapse-single-table">
                <h3 class="panel-title">单表生成代码</h3></a>
        </div>
        <div id="collapse-single-table" class="panel-collapse collapse">
            <div class="panel-body">
                <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label for="single-table-code-package" class="col-sm-2 control-label">包名</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="single-table-code-package" placeholder="请输入包名"
                                   value="com.chqiuu">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="single-table-author" class="col-sm-2 control-label">创建人</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="single-table-author" placeholder="请输入创建人"
                                   value="chqiuu">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="single-table-name" class="col-sm-2 control-label">表名</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="single-table-name" placeholder="请输入数据库表名">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="single-table-name" class="col-sm-2 control-label">是否为Mybatis-Plus</label>
                        <div class="col-sm-10">
                            <input type="checkbox" class="form-control" id="single-is-plus"
                                   placeholder="是否为Mybatis-Plus"
                                   value="false">
                        </div>
                    </div>
                </form>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button id="single-table-submit" type="submit" class="btn btn-primary">开始生成</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="panel panel-info">
        <div class="panel-heading">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapse-multi-table">
                <h3 class="panel-title">多表批量生成代码</h3></a>
        </div>
        <div id="collapse-multi-table" class="panel-collapse collapse">
            <div class="panel-body">
                <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label for="multi-table-code-package" class="col-sm-2 control-label">包名</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="multi-table-code-package" placeholder="请输入包名"
                                   value="com.chqiuu">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="multi-table-author" class="col-sm-2 control-label">创建人</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="multi-table-author" placeholder="请输入创建人"
                                   value="chqiuu">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="multi-table-names" class="col-sm-2 control-label">表名列表</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="multi-table-names"
                                   placeholder="请输入表名列表，以英文逗号隔开">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="single-table-name" class="col-sm-2 control-label">是否为Mybatis-Plus</label>
                        <div class="col-sm-10">
                            <input type="checkbox" class="form-control" id="multi-is-plus" placeholder="是否为Mybatis-Plus"
                                   value="false">
                        </div>
                    </div>
                </form>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button id="multi-table-submit" type="submit" class="btn btn-primary">开始生成</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="panel panel-info">
        <div class="panel-heading">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapse-all-table">
                <h3 class="panel-title">全表批量生成代码</h3>
            </a>
        </div>
        <div id="collapse-all-table" class="panel-collapse collapse">
            <div class="panel-body">
                <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label for="all-table-code-package" class="col-sm-2 control-label">包名</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="all-table-code-package" placeholder="请输入包名"
                                   value="com.chqiuu">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="all-table-author" class="col-sm-2 control-label">创建人</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="all-table-author" placeholder="请输入创建人"
                                   value="chqiuu">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="single-table-name" class="col-sm-2 control-label">是否为Mybatis-Plus</label>
                        <div class="col-sm-10">
                            <input type="checkbox" class="form-control" id="all-is-plus" placeholder="是否为Mybatis-Plus"
                                   value="false">
                        </div>
                    </div>
                </form>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button id="all-table-submit" type="submit" class="btn btn-primary">开始生成</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="json-div" style="display:none;"></div>
<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-jsonview/1.2.3/jquery.jsonview.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/layer/2.3/layer.js"></script>
<script>
    $(document).ready(function () {
        $('#connect-db-submit').bind('click', function () {
            $('#connect-db-submit').attr("disabled", true);
            $.ajax({
                type: "post",
                url: "../generator/connectDatabase",
                async: true,
                data: {
                    dbType: $('#db-type').find("option:selected").text(),
                    server: $('#db-server').val(),
                    database: $('#db-database').val(),
                    port: $('#db-port').val(),
                    username: $('#db-username').val(),
                    password: $('#db-password').val()
                },
                success: function (data) {
                    if (data.code === 1) {
                        // 数据库连接成功
                        $('#db-connect-div').removeClass('panel-info').removeClass("panel-danger").addClass('panel-success');
                        $('#gen-div').removeClass('hidden');
                        $('#collapse-db').collapse('hide');
                        $('#collapse-single-table').collapse('show');
                        $('#collapse-multi-table').collapse('show');
                        $('#collapse-all-table').collapse('show');
                    } else {
                        $('#db-connect-div').removeClass('panel-info').removeClass('panel-success').addClass('panel-danger');
                    }
                }
            });
            $('#connect-db-submit').removeAttr("disabled");
        });

        $('#single-table-submit').bind('click', function () {
            var url = '';
            window.open(url.concat('../generator/code?codePackage=', $('#single-table-code-package').val()
                , '&author=', $('#single-table-author').val(), '&table=', $('#single-table-name').val(), '&isPlus=', $('#single-is-plus').is(":checked")));
        });
        $('#multi-table-submit').bind('click', function () {
            var url = '';
            window.open(url.concat('../generator/codes?codePackage=', $('#multi-table-code-package').val()
                , '&author=', $('#multi-table-author').val(), '&tables=', $('#multi-table-names').val(), '&isPlus=', $('#multi-is-plus').is(":checked")));
        });
        $('#all-table-submit').bind('click', function () {
            var url = '';
            window.open(url.concat('../generator/codeAll?codePackage=', $('#all-table-code-package').val()
                , '&author=', $('#all-table-author').val(), '&isPlus=', $('#all-is-plus').is(":checked")));
        });
    });

    //显示JSON数据
    function showJSON(title, json) {
        $("#json-div").JSONView(json);
        layer.open({
            type: 1,
            title: "[" + title + "]" + "返回JSON", //不显示标题
            area: ['40%', '80%'],
            content: $('#json-div'), //捕获的元素，注意：最好该指定的元素要存放在body最外层，否则可能被其它的相对元素所影响
            time: 2000, //2s后自动关闭
            shade: 0,
            shadeClose: true,
        });
    }
</script>
</body>
</html>