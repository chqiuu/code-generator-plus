(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05ecccf4"],{"933b":function(e,t,r){},fa48:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-steps",{attrs:{active:e.stepActive,"align-center":"","finish-status":"success"}},[r("el-step",{attrs:{title:"第1步：数据表来源",description:"您可以选择从数据库或者直接导入数据库表创建脚本"}}),e._v(" "),r("el-step",{attrs:{title:"第2步：生成代码",description:"设置项目参数"}})],1),e._v(" "),0==e.stepActive?r("div",{staticClass:"connection-db"},[r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{attrs:{label:"连接数据库"}},[r("div",[r("el-form",{ref:"connectDbForm",attrs:{model:e.connectInfo,rules:e.connectRules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"数据库类型",prop:"dbType"}},[r("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择数据库类型",clearable:""},model:{value:e.connectInfo.dbType,callback:function(t){e.$set(e.connectInfo,"dbType",t)},expression:"connectInfo.dbType"}},e._l(e.dbTypeOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"服务器地址",prop:"server"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入服务器地址",clearable:""},model:{value:e.connectInfo.server,callback:function(t){e.$set(e.connectInfo,"server",t)},expression:"connectInfo.server"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"端口号",prop:"port"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入端口号",clearable:""},model:{value:e.connectInfo.port,callback:function(t){e.$set(e.connectInfo,"port",t)},expression:"connectInfo.port"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"数据库名",prop:"database"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入数据库名",clearable:""},model:{value:e.connectInfo.database,callback:function(t){e.$set(e.connectInfo,"database",t)},expression:"connectInfo.database"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"登录名",prop:"username"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入登录名",clearable:""},model:{value:e.connectInfo.username,callback:function(t){e.$set(e.connectInfo,"username",t)},expression:"connectInfo.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"登录密码",prop:"password"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入登录密码",clearable:"","show-password":""},model:{value:e.connectInfo.password,callback:function(t){e.$set(e.connectInfo,"password",t)},expression:"connectInfo.password"}})],1),e._v(" "),r("el-form-item",{attrs:{size:"large"}},[r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitConnectDatabaseForm}},[e._v("连接数据库")]),e._v(" "),r("el-button",{on:{click:e.resetConnectDatabaseForm}},[e._v("重置")])],1)],1)],1)]),e._v(" "),r("el-tab-pane",{attrs:{label:"导入SQL脚本"}},[r("el-form",{ref:"importSqlForm",attrs:{model:e.importSql,rules:e.sqlRules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"数据库类型",prop:"dbType"}},[r("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择数据库类型",clearable:""},model:{value:e.connectInfo.dbType,callback:function(t){e.$set(e.connectInfo,"dbType",t)},expression:"connectInfo.dbType"}},e._l(e.dbTypeOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"SQL脚本",prop:"ddl"}},[r("el-input",{style:{width:"100%"},attrs:{type:"textarea",placeholder:"请输入SQL CREATE脚本，可以直接多表，建议使用Navicat工具生成都DDL脚本",autosize:{minRows:26,maxRows:28}},model:{value:e.importSql.ddl,callback:function(t){e.$set(e.importSql,"ddl",t)},expression:"importSql.ddl"}})],1),e._v(" "),r("el-form-item",{attrs:{size:"large"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitImportSqlForm}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:e.resetImportSqlForm}},[e._v("重置")])],1)],1)],1)],1)],1):e._e(),e._v(" "),1==e.stepActive?r("div",{staticClass:"select-table"},[r("div",{staticClass:"generator-code"},[r("el-form",{ref:"generatorForm",attrs:{model:e.generatorInfo,rules:e.generatorRules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"项目主包名",prop:"rootPackage"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入项目主包名。如：com.chqiuu",clearable:""},model:{value:e.generatorInfo.rootPackage,callback:function(t){e.$set(e.generatorInfo,"rootPackage",t)},expression:"generatorInfo.rootPackage"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"创建人",prop:"author"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入创建人。如：chqiuu",clearable:""},model:{value:e.generatorInfo.author,callback:function(t){e.$set(e.generatorInfo,"author",t)},expression:"generatorInfo.author"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"MyBatis-Plus",prop:"isPlus"}},[r("el-checkbox",{model:{value:e.generatorInfo.isPlus,callback:function(t){e.$set(e.generatorInfo,"isPlus",t)},expression:"generatorInfo.isPlus"}},[e._v("是否生成MyBatis-Plus模式代码")])],1),e._v(" "),r("el-form-item",{attrs:{size:"large"}},[r("el-button",{on:{click:e.batchSetModule}},[e._v("设置模块")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitGeneratorForm}},[e._v("生成代码")])],1)],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"dbTable",attrs:{data:e.tableList?e.tableList.filter((function(t){return!e.search||(t.tableComment?t.tableComment:"").toLowerCase().includes(e.search.toLowerCase())||(t.tableName?t.tableName:"").toLowerCase().includes(e.search.toLowerCase())})):null,"element-loading-text":"Loading","tooltip-effect":"dark","row-class-name":e.dbTableRowClassName},on:{"selection-change":e.dbTableSelectionChange,"row-click":e.dbTableRowClick}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{label:"表名",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.tableName)+"\n        ")]}}],null,!1,3592682916)}),e._v(" "),r("el-table-column",{attrs:{label:"表注释",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.tableComment))])]}}],null,!1,3096904811)}),e._v(" "),r("el-table-column",{attrs:{label:"字段数",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.columns.length)+"\n        ")]}}],null,!1,436791690)}),e._v(" "),r("el-table-column",{attrs:{prop:"module",label:"模块",sortable:"",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.module?r("el-tag",{attrs:{type:null===t.row.module?"":"success","disable-transitions":""}},[e._v(e._s(t.row.module))]):e._e()]}}],null,!1,3619896985)}),e._v(" "),r("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}}],null,!1,775912124)})],1)],1):e._e(),e._v(" "),1==e.stepActive?r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:e.lastStep}},[e._v("上一步")]):e._e(),e._v(" "),0==e.stepActive?r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"success"},on:{click:e.nextStep}},[e._v("下一步")]):e._e()],1)},n=[],o=(r("ac6a"),r("96cf"),r("1da1")),s=(r("28a5"),r("a481"),r("bc3a")),l=r.n(s),i=r("4328"),c=r.n(i),u=(r("53ca"),r("56cd")),d=function(e,t){t=t||"success","warning"!==t?"error"!==t?Object(u["a"])({message:e,duration:4}):u["a"].error({message:e,duration:4}):u["a"].warn({message:e,duration:4})},p=r("a18c");r("1368").polyfill();var m=!1,b="/code-generator-plus";l.a.interceptors.request.use((function(e){if("post"===e.method)for(var t in b+"/login"===e.url&&(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=c.a.stringify(e.data,{arrayFormat:"brackets"},{indices:!1})),e.data)null===e.data[t]&&delete e.data[t];return e}),(function(e){return Promise.reject(e)})),l.a.interceptors.response.use((function(e){if(1!==e.data.code&&(e.config.params&&e.config.params.noError?console.error(e.data.message):d(e.data.message,"error")),10231===e.data.code)if(m){var t=p["a"].currentRoute.path;if("/login"===t)return e;p["a"].replace({path:"/login",query:{redirect:t}})}else window.location.href=b;return e}),(function(e){return d("服务器错误","error"),Promise.reject(e)}));var f=function(e,t){var r,a=/({\w+})/g,n=e;while(null!==(r=a.exec(e))){var o=t[r[0].slice(1,-1)];if(!o)throw new Error("参数错误");n=n.replace(r[0],o),delete t[r[0].slice(1,-1)]}return{url:n,data:t}},g=function(e,t){var r=f(e,t),a=r.url,n=r.data;return new Promise((function(e,t){l.a.post(a,n).then((function(r){1===r.data.code?e(r.data.data):t(r.data.message)})).catch((function(){t("服务器错误")}))}))},h=function(e,t){var r=f(e,t),a=r.url,n=r.data;return new Promise((function(e,t){l()({method:"post",url:a,data:n,responseType:"blob"}).then((function(e){if(200===e.status){var r=e.data,a=new Blob([r]),n="";if(n=e.headers["content-disposition"].split(";").length>0?e.headers["content-disposition"].split(";")[1].split("=")[1]:"data.csv","download"in document.createElement("a")){var o=document.createElement("a");o.download=n,o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)}else navigator.msSaveBlob(a,n)}else t("文件下载失败")})).catch((function(){t("服务器错误")}))}))},v=function(e,t){var r=f(e,t),a=r.url,n=r.data;return new Promise((function(e,t){l.a.get(a,{params:n}).then((function(r){1===r.data.code?e(r.data.data):t(r.data.message)})).catch((function(){t("服务器错误")}))}))},w=(l.a,{generatorConnectDatabase:function(e){return v("".concat(b,"/generator/connectDatabase"),e)},generatorImportSql:function(e){return g("".concat(b,"/generator/importSql"),e)},generatorGetAllTableList:function(){return v("".concat(b,"/generator/getAllTables"),null)},generatorGeneratorCodes:function(e){return h("".concat(b,"/generator/generatorCodes"),e)},generatorGetTableList:function(e){return v("".concat(b,"/generator/queryTableList"),e)},generatorCode:function(e){return v("".concat(b,"/generator/code"),e)},generatorCodes:function(e){return v("".concat(b,"/generator/codes"),e)},generatorCodeAll:function(e){return v("".concat(b,"/generator/codeAll"),e)}}),y={filters:{statusFilter:function(e){var t={published:"success",draft:"gray",deleted:"danger"};return t[e]}},components:{},props:[],data:function(){return{loading:!1,tableList:null,listLoading:!0,search:"",stepActive:0,connectInfo:{dbType:"MySQL",server:"127.0.0.1",port:3306,database:"mysql",username:"root",password:"root"},importSql:{dbType:"MySQL",ddl:null},generatorInfo:{rootPackage:"com.chqiuu",author:"chqiuu",isPlus:!0,tables:[]},connectRules:{dbType:[{required:!0,message:"请选择数据库类型",trigger:"change"}],server:[{required:!0,message:"请输入单行文本服务器地址",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"}],database:[{required:!0,message:"请输入数据库名",trigger:"blur"}],username:[{required:!0,message:"请输入登录名",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}]},sqlRules:{dbType:[{required:!0,message:"请选择数据库类型",trigger:"change"}],ddl:[{required:!0,message:"请输入数据库脚本",trigger:"blur"}]},generatorRules:{rootPackage:[{required:!0,message:"请输入项目主包名",trigger:"blur"},{required:!0,pattern:/^[a-z.]+$/,message:"项目主包名格式有误",trigger:"blur"}],author:[{required:!0,message:"请输入作者名",trigger:"blur"}]},dbTypeOptions:[{label:"MySQL",value:"MySQL"},{label:"SQLite",value:"SQLite"},{label:"SQLServer",value:"SQLServer"},{label:"Oracle",value:"Oracle"},{label:"H2",value:"H2"}]}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{lastStep:function(){this.stepActive>0&&this.stepActive--},nextStep:function(){this.stepActive<1&&(this.stepActive++,this.fetchTableData())},submitConnectDatabaseForm:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,w.generatorConnectDatabase(this.connectInfo);case 4:t=e.sent,console.log("result",t),this.loading=!1,this.$message.success("恭喜你，数据库连接成功"),this.stepActive++,this.fetchTableData(),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),this.$message.error("数据库连接失败",e.t0),this.loading=!1;case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));function t(){return e.apply(this,arguments)}return t}(),resetConnectDatabaseForm:function(){this.$refs["connectDbForm"].resetFields()},submitImportSqlForm:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,w.generatorImportSql(this.importSql);case 4:this.$message.success("恭喜你，SQL导入成功"),this.loading=!1,this.stepActive++,this.fetchTableData(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),this.$message.error("SQL导入失败"+e.t0),this.loading=!1;case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(){return e.apply(this,arguments)}return t}(),resetImportSqlForm:function(){this.$refs["importSqlForm"].resetFields()},fetchTableData:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.next=3,w.generatorGetAllTableList();case 3:t=e.sent,this.tableList=t,this.listLoading=!1,this.$message.success("获取数据库表成功");case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),batchSetModule:function(){var e=this;0!==this.generatorInfo.tables.length?this.$prompt("请输入模块名称","设置模块名",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[a-z]+$/,inputErrorMessage:"模块格式有误，必须为小写英文字符串"}).then((function(t){var r=t.value;e.tableList.forEach((function(t){e.generatorInfo.tables.forEach((function(e){t.tableName===e.tableName&&(t.module=r,e.module=r)}))})),e.$refs.dbTable.clearSelection(),e.$message.success("模块设置成功")})).catch((function(){e.$message.info("取消输入")})):this.$message.error("请先选择数据库表")},dbTableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2===0?"warning-row":""},dbTableSelectionChange:function(e){this.generatorInfo.tables=e},dbTableRowClick:function(e){this.$refs.dbTable.toggleRowSelection(e)},submitGeneratorForm:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.generatorInfo.tables.length){e.next=3;break}return this.$message.error("请选择需要生成代码的数据库表"),e.abrupt("return");case 3:return this.tableList.forEach((function(e){r.generatorInfo.tables.forEach((function(t){e.tableName!==t.tableName||null!=t.module||r.$message.error("请给需要生成都表设置模块名")}))})),this.listLoading=!0,e.next=7,w.generatorGeneratorCodes(this.generatorInfo);case 7:t=e.sent,console.log("result",t),this.listLoading=!1,this.$message.success("下载成功");case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},_=y,k=(r("fb03"),r("2877")),I=Object(k["a"])(_,a,n,!1,null,null,null);t["default"]=I.exports},fb03:function(e,t,r){"use strict";var a=r("933b"),n=r.n(a);n.a}}]);