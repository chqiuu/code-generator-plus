(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f304cd66"],{"4ec3":function(e,t,r){"use strict";r("28a5"),r("a481");var a=r("bc3a"),n=r.n(a),o=r("4328"),s=r.n(o),l=(r("ac6a"),r("53ca"),r("56cd")),c=function(e,t){t=t||"success","warning"!==t?"error"!==t?Object(l["a"])({message:e,duration:4}):l["a"].error({message:e,duration:4}):l["a"].warn({message:e,duration:4})},i=r("a18c");r("1368").polyfill();var u=!1,d=u?"/api":"";n.a.interceptors.request.use((function(e){if("post"===e.method)for(var t in d+"/login"===e.url&&(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s.a.stringify(e.data,{arrayFormat:"brackets"},{indices:!1})),e.data)null===e.data[t]&&delete e.data[t];return e}),(function(e){return Promise.reject(e)})),n.a.interceptors.response.use((function(e){if(1!==e.data.code&&(e.config.params&&e.config.params.noError?console.error(e.data.message):c(e.data.message,"error")),10231===e.data.code)if(u){var t=i["a"].currentRoute.path;if("/login"===t)return e;i["a"].replace({path:"/login",query:{redirect:t}})}else window.location.href=d;return e}),(function(e){return c("服务器错误","error"),Promise.reject(e)}));var p=function(e,t){var r,a=/({\w+})/g,n=e;while(null!==(r=a.exec(e))){var o=t[r[0].slice(1,-1)];if(!o)throw new Error("参数错误");n=n.replace(r[0],o),delete t[r[0].slice(1,-1)]}return{url:n,data:t}},b=function(e,t){var r=p(e,t),a=r.url,o=r.data;return new Promise((function(e,t){n.a.post(a,o).then((function(r){1===r.data.code?e(r.data.data):t(r.data.message)})).catch((function(){t("服务器错误")}))}))},f=function(e,t){var r=p(e,t),a=r.url,o=r.data;return new Promise((function(e,t){n()({method:"post",url:a,data:o,responseType:"blob"}).then((function(e){if(200===e.status){var r=e.data,a=new Blob([r]),n="";if(n=e.headers["content-disposition"].split(";").length>0?e.headers["content-disposition"].split(";")[1].split("=")[1]:"data.csv","download"in document.createElement("a")){var o=document.createElement("a");o.download=n,o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)}else navigator.msSaveBlob(a,n)}else t("文件下载失败")})).catch((function(){t("服务器错误")}))}))},m=function(e,t){var r=p(e,t),a=r.url,o=r.data;return new Promise((function(e,t){n.a.get(a,{params:o}).then((function(r){1===r.data.code?e(r.data.data):t(r.data.message)})).catch((function(){t("服务器错误")}))}))};n.a,t["a"]={generatorConnectDatabase:function(e){return console.log("${HEAD}"+d),b("".concat(d,"/generator/connectDatabase"),e)},generatorImportSql:function(e){return b("".concat(d,"/generator/importSql"),e)},generatorGetAllTableList:function(){return m("".concat(d,"/generator/getAllTables"),null)},generatorGeneratorCodes:function(e){return f("".concat(d,"/generator/generatorCodes"),e)},generatorGetTableList:function(e){return m("".concat(d,"/generator/queryTableList"),e)},generatorCode:function(e){return m("".concat(d,"/generator/code"),e)},generatorPreview:function(e){return m("".concat(d,"/generator/preview"),e)},generatorCodes:function(e){return m("".concat(d,"/generator/codes"),e)},generatorCodeAll:function(e){return m("".concat(d,"/generator/codeAll"),e)}}},"933b":function(e,t,r){},b85c:function(e,t,r){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function n(e,t){if(e){if("string"===typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function o(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return l=e.done,e},e:function(e){c=!0,s=e},f:function(){try{l||null==r["return"]||r["return"]()}finally{if(c)throw s}}}}r.d(t,"a",(function(){return o}))},fa48:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-steps",{attrs:{active:e.stepActive,"align-center":"","finish-status":"success"}},[r("el-step",{attrs:{title:"第1步：数据表来源",description:"您可以选择从数据库或者直接导入数据库表创建脚本"}}),e._v(" "),r("el-step",{attrs:{title:"第2步：生成代码",description:"设置项目参数"}})],1),e._v(" "),0==e.stepActive?r("div",{staticClass:"connection-db"},[r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{attrs:{label:"连接数据库"}},[r("div",[r("el-form",{ref:"connectDbForm",attrs:{model:e.connectInfo,rules:e.connectRules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"数据库类型",prop:"dbType"}},[r("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择数据库类型",clearable:""},model:{value:e.connectInfo.dbType,callback:function(t){e.$set(e.connectInfo,"dbType",t)},expression:"connectInfo.dbType"}},e._l(e.dbTypeOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"服务器地址",prop:"server"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入服务器地址",clearable:""},model:{value:e.connectInfo.server,callback:function(t){e.$set(e.connectInfo,"server",t)},expression:"connectInfo.server"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"端口号",prop:"port"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入端口号",clearable:""},model:{value:e.connectInfo.port,callback:function(t){e.$set(e.connectInfo,"port",t)},expression:"connectInfo.port"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"数据库名",prop:"database"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入数据库名",clearable:""},model:{value:e.connectInfo.database,callback:function(t){e.$set(e.connectInfo,"database",t)},expression:"connectInfo.database"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"登录名",prop:"username"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入登录名",clearable:""},model:{value:e.connectInfo.username,callback:function(t){e.$set(e.connectInfo,"username",t)},expression:"connectInfo.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"登录密码",prop:"password"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入登录密码",clearable:"","show-password":""},model:{value:e.connectInfo.password,callback:function(t){e.$set(e.connectInfo,"password",t)},expression:"connectInfo.password"}})],1),e._v(" "),r("el-form-item",{attrs:{size:"large"}},[r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitConnectDatabaseForm}},[e._v("连接数据库")]),e._v(" "),r("el-button",{on:{click:e.resetConnectDatabaseForm}},[e._v("重置")])],1)],1)],1)]),e._v(" "),r("el-tab-pane",{attrs:{label:"导入SQL脚本"}},[r("el-form",{ref:"importSqlForm",attrs:{model:e.importSql,rules:e.sqlRules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"数据库类型",prop:"dbType"}},[e._v("o\n            "),r("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择数据库类型",clearable:""},model:{value:e.connectInfo.dbType,callback:function(t){e.$set(e.connectInfo,"dbType",t)},expression:"connectInfo.dbType"}},e._l(e.dbTypeOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"SQL脚本",prop:"ddl"}},[r("el-input",{style:{width:"100%"},attrs:{type:"textarea",placeholder:"请输入SQL CREATE脚本，可以直接多表，建议使用Navicat工具生成都DDL脚本",autosize:{minRows:20,maxRows:20}},model:{value:e.importSql.ddl,callback:function(t){e.$set(e.importSql,"ddl",t)},expression:"importSql.ddl"}})],1),e._v(" "),r("el-form-item",{attrs:{size:"large"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitImportSqlForm}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:e.resetImportSqlForm}},[e._v("重置")])],1)],1)],1)],1)],1):e._e(),e._v(" "),1==e.stepActive?r("div",{staticClass:"select-table"},[r("div",{staticClass:"generator-code"},[r("el-form",{ref:"generatorForm",attrs:{model:e.generatorInfo,rules:e.generatorRules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"项目主包名",prop:"rootPackage"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入项目主包名。如：com.chqiuu",clearable:""},model:{value:e.generatorInfo.rootPackage,callback:function(t){e.$set(e.generatorInfo,"rootPackage",t)},expression:"generatorInfo.rootPackage"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"创建人",prop:"author"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入创建人。如：chqiuu",clearable:""},model:{value:e.generatorInfo.author,callback:function(t){e.$set(e.generatorInfo,"author",t)},expression:"generatorInfo.author"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"MyBatis-Plus",prop:"isPlus"}},[r("el-checkbox",{model:{value:e.generatorInfo.isPlus,callback:function(t){e.$set(e.generatorInfo,"isPlus",t)},expression:"generatorInfo.isPlus"}},[e._v("是否生成MyBatis-Plus模式代码")])],1),e._v(" "),r("el-form-item",{attrs:{size:"large"}},[r("el-button",{on:{click:e.batchSetModule}},[e._v("设置模块")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitGeneratorForm}},[e._v("生成代码")])],1)],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"dbTable",attrs:{data:e.tableList?e.tableList.filter((function(t){return!e.search||(t.tableComment?t.tableComment:"").toLowerCase().includes(e.search.toLowerCase())||(t.tableName?t.tableName:"").toLowerCase().includes(e.search.toLowerCase())})):null,"element-loading-text":"Loading","tooltip-effect":"dark","row-class-name":e.dbTableRowClassName},on:{"selection-change":e.dbTableSelectionChange,"row-click":e.dbTableRowClick}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{label:"表名",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.tableName)+"\n        ")]}}],null,!1,3592682916)}),e._v(" "),r("el-table-column",{attrs:{label:"表注释",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.tableComment))])]}}],null,!1,3096904811)}),e._v(" "),r("el-table-column",{attrs:{label:"字段数",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.columns.length)+"\n        ")]}}],null,!1,436791690)}),e._v(" "),r("el-table-column",{attrs:{prop:"module",label:"模块",sortable:"",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.module?r("el-tag",{attrs:{type:null===t.row.module?"":"success","disable-transitions":""}},[e._v(e._s(t.row.module))]):e._e()]}}],null,!1,3619896985)}),e._v(" "),r("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[r("el-popover",{attrs:{placement:"right",width:"500",trigger:"hover"}},[r("el-table",{attrs:{data:t.row.columns}},[r("el-table-column",{attrs:{width:"150",property:"columnName",label:"字段名"}}),e._v(" "),r("el-table-column",{attrs:{width:"300",property:"columnComment",label:"字段注释"}})],1),e._v(" "),r("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("字段信息")])],1)]}}],null,!1,1551909700)})],1)],1):e._e(),e._v(" "),1==e.stepActive?r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:e.lastStep}},[e._v("上一步")]):e._e(),e._v(" "),0==e.stepActive?r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"success"},on:{click:e.nextStep}},[e._v("下一步")]):e._e()],1)},n=[],o=r("b85c"),s=(r("ac6a"),r("96cf"),r("1da1")),l=r("4ec3"),c={filters:{statusFilter:function(e){var t={published:"success",draft:"gray",deleted:"danger"};return t[e]}},components:{},props:[],data:function(){return{loading:!1,tableList:null,columnList:null,listLoading:!0,search:"",stepActive:0,connectInfo:{dbType:"MySQL",server:"127.0.0.1",port:3306,database:"mysql",username:"root",password:"root"},importSql:{dbType:"MySQL",ddl:null},generatorInfo:{rootPackage:"com.chqiuu",author:"chqiuu",isPlus:!0,tables:[]},connectRules:{dbType:[{required:!0,message:"请选择数据库类型",trigger:"change"}],server:[{required:!0,message:"请输入服务器地址",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"}],database:[{required:!0,message:"请输入数据库名",trigger:"blur"}],username:[{required:!0,message:"请输入登录名",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}]},sqlRules:{dbType:[{required:!0,message:"请选择数据库类型",trigger:"change"}],ddl:[{required:!0,message:"请输入数据库脚本",trigger:"blur"}]},generatorRules:{rootPackage:[{required:!0,message:"请输入项目主包名",trigger:"blur"},{required:!0,pattern:/^[a-z.]+$/,message:"项目主包名格式有误",trigger:"blur"}],author:[{required:!0,message:"请输入作者名",trigger:"blur"}]},dbTypeOptions:[{label:"MySQL",value:"MySQL"},{label:"SQLite",value:"SQLite"},{label:"SQLServer",value:"SQLServer"},{label:"Oracle",value:"Oracle"},{label:"H2",value:"H2"}]}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{lastStep:function(){this.stepActive>0&&this.stepActive--},nextStep:function(){this.stepActive<1&&(this.stepActive++,this.fetchTableData())},submitConnectDatabaseForm:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,l["a"].generatorConnectDatabase(this.connectInfo);case 4:t=e.sent,console.log("result",t),this.loading=!1,this.$message.success("恭喜你，数据库连接成功"),this.stepActive++,this.fetchTableData(),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),this.$message.error("数据库连接失败",e.t0),this.loading=!1;case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));function t(){return e.apply(this,arguments)}return t}(),resetConnectDatabaseForm:function(){this.$refs["connectDbForm"].resetFields()},submitImportSqlForm:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,l["a"].generatorImportSql(this.importSql);case 4:this.$message.success("恭喜你，SQL导入成功"),this.loading=!1,this.stepActive++,this.fetchTableData(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),this.$message.error("SQL导入失败"+e.t0),this.loading=!1;case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(){return e.apply(this,arguments)}return t}(),resetImportSqlForm:function(){this.$refs["importSqlForm"].resetFields()},fetchTableData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.prev=1,e.next=4,l["a"].generatorGetAllTableList();case 4:t=e.sent,this.tableList=t,this.listLoading=!1,this.$message.success("获取数据库表成功"),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](1),this.$message.error("数据库表获取失败，请先连接数据库或导入SQL脚本"+e.t0),this.stepActive--,this.loading=!1;case 15:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(){return e.apply(this,arguments)}return t}(),batchSetModule:function(){var e=this;0!==this.generatorInfo.tables.length?this.$prompt("请输入模块名称","设置模块名",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[a-z]+$/,inputErrorMessage:"模块格式有误，必须为小写英文字符串"}).then((function(t){var r=t.value;e.tableList.forEach((function(t){e.generatorInfo.tables.forEach((function(a){t.tableName===a.tableName&&(t.module=r,a.module=r,e.$set(e.tableData,e.tableIndex,e.amendForm))}))})),e.$message.success("模块设置成功")})).catch((function(){e.$message.info("取消输入")})):this.$message.error("请先选择数据库表")},dbTableRowClassName:function(e){e.row;var t=e.index;return t%2===0?"warning-row":""},dbTableSelectionChange:function(e){this.generatorInfo.tables=e},dbTableRowClick:function(e){this.$refs.dbTable.toggleRowSelection(e)},submitGeneratorForm:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r,a,n,s,c,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.generatorInfo.tables.length){e.next=3;break}return this.$message.error("请选择需要生成代码的数据库表"),e.abrupt("return");case 3:t=Object(o["a"])(this.tableList),e.prev=4,t.s();case 6:if((r=t.n()).done){e.next=28;break}a=r.value,n=Object(o["a"])(this.generatorInfo.tables),e.prev=9,n.s();case 11:if((s=n.n()).done){e.next=18;break}if(c=s.value,a.tableName!==c.tableName||null!=c.module){e.next=16;break}return this.$message.error("请给需要生成都表设置模块名"),e.abrupt("return");case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](9),n.e(e.t0);case 23:return e.prev=23,n.f(),e.finish(23);case 26:e.next=6;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e["catch"](4),t.e(e.t1);case 33:return e.prev=33,t.f(),e.finish(33);case 36:return e.prev=36,e.next=39,l["a"].generatorGeneratorCodes(this.generatorInfo);case 39:i=e.sent,console.log("result",i),this.$message.success("下载成功"),e.next=47;break;case 44:e.prev=44,e.t2=e["catch"](36),this.$message.error("下载失败："+e.t2);case 47:case"end":return e.stop()}}),e,this,[[4,30,33,36],[9,20,23,26],[36,44]])})));function t(){return e.apply(this,arguments)}return t}()}},i=c,u=(r("fb03"),r("2877")),d=Object(u["a"])(i,a,n,!1,null,null,null);t["default"]=d.exports},fb03:function(e,t,r){"use strict";var a=r("933b"),n=r.n(a);n.a}}]);